package com.chengxin.fragment;import java.util.ArrayList;import java.util.List;import android.content.Context;import android.content.Intent;import android.os.Bundle;import android.support.v4.app.Fragment;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.AdapterView;import android.widget.AdapterView.OnItemClickListener;import android.widget.GridView;import com.chengxin.CaptureActivity;import com.chengxin.PublicNoActivity;import com.chengxin.R;import com.chengxin.Entity.GridViewMenuItem;import com.chengxin.Entity.MerchantCategory;import com.chengxin.adapter.GridMenuAdapter;import com.chengxin.global.WeiYuanCommon;import com.chengxin.market.MarketMainActivity;import com.chengxin.net.WeiYuanException;import com.chengxin.services.DemandActivity;import com.chengxin.services.OrderActivity;import com.chengxin.services.merchant.MerchantActivity;public class ServicesMainFragment extends Fragment implements OnItemClickListener{	private Context mParentContext;	private View mView;		private GridView mGrid;	private GridMenuAdapter mAdapter;	private List < GridViewMenuItem > mList = new ArrayList<GridViewMenuItem>();	private AdViewFragment adviewFragment;	@Override	public void onActivityCreated(Bundle savedInstanceState) {		super.onActivityCreated(savedInstanceState);				mGrid = (GridView)mView.findViewById(R.id.grid_menu);		mGrid.setOnItemClickListener(this);		initMenuData();				adviewFragment = (AdViewFragment) getFragmentManager()				.findFragmentById(R.id.ads_fragment);				adviewFragment.setAdList(WeiYuanCommon.getAdLocalList());	}	private void initMenuData() {		mList.clear();				mList.add(new GridViewMenuItem(1, "scan_it", "扫码"));		mList.add(new GridViewMenuItem(2, "reqery_it", "需求"));		mList.add(new GridViewMenuItem(3, "order_it", "订单"));		mList.add(new GridViewMenuItem(4, "public_it", "公众号"));		mList.add(new GridViewMenuItem(5, "market_it", "菜篮子"));		mList.add(new GridViewMenuItem(6, "agritourism_it", "农家乐"));		mList.add(new GridViewMenuItem(7, "hotel_it", "住宿"));		mList.add(new GridViewMenuItem(8, "catering_it", "餐饮"));		mList.add(new GridViewMenuItem(9, "entertainment_it", "休闲娱乐"));				mAdapter = new GridMenuAdapter(mParentContext, mList);		mGrid.setAdapter(mAdapter);	}	@Override	public void onCreate(Bundle savedInstanceState) {		super.onCreate(savedInstanceState);		mParentContext = (Context) ServicesMainFragment.this.getActivity();		getMerchantType();	}	@Override	public View onCreateView(LayoutInflater inflater, ViewGroup container,			Bundle savedInstanceState) {		mView = inflater.inflate(R.layout.services_main, container, false);		return mView;	}	@Override	public void onDestroy() {		super.onDestroy();	}		@Override	public void onDestroyView() {		super.onDestroyView();		// 内嵌的Fragment GoodsListFragment		if (adviewFragment != null) {			getFragmentManager().beginTransaction().remove(adviewFragment)					.commit();		}	}	@Override	public void onItemClick(AdapterView<?> gridView, View convertView, int position, long id) {		Intent intent = null;				switch (position) {		case 0: // 扫码			intent = new Intent();			intent.setClass(getActivity(), CaptureActivity.class);			getActivity().startActivity(intent);						break;		case 1:	// 需求			intent = new Intent();			intent.setClass(getActivity(), DemandActivity.class);			getActivity().startActivity(intent);						break;		case 2:	// 订单			intent = new Intent();			intent.setClass(getActivity(), OrderActivity.class);			getActivity().startActivity(intent);						break;		case 3:	// 公众号			intent = new Intent();			intent.setClass(getActivity(), PublicNoActivity.class);			getActivity().startActivity(intent);						break;		case 4:	// 菜篮子			intent = new Intent();			intent.setClass(getActivity(), MarketMainActivity.class);			getActivity().startActivity(intent);						break;		case 5: // 农家乐			intent = new Intent();			intent.setClass(getActivity(), MerchantActivity.class);			intent.putExtra("merchant", 1);			getActivity().startActivity(intent);			break;		case 6: // 住宿			intent = new Intent();			intent.setClass(getActivity(), MerchantActivity.class);			intent.putExtra("merchant", 2);			getActivity().startActivity(intent);			break;		case 7: // 餐饮			intent = new Intent();			intent.setClass(getActivity(), MerchantActivity.class);			intent.putExtra("merchant", 4);			getActivity().startActivity(intent);			break;		case 8: // 休闲娱乐			intent = new Intent();			intent.setClass(getActivity(), MerchantActivity.class);			intent.putExtra("merchant", 3);			getActivity().startActivity(intent);			break;		default:			break;		}	}	private void getMerchantType(){		if (MerchantCategory.hasData()) {			return;		}				if(!WeiYuanCommon.getNetWorkState()){			return;		}		new Thread(){			public void run() {				try {					MerchantCategory merchantMenu =	WeiYuanCommon.getWeiYuanInfo().getMerchantCategory();										if (merchantMenu != null) {						return;					}				} catch (WeiYuanException e) {					e.printStackTrace();				}catch (Exception e) {					e.printStackTrace();				}			};		}.start();	}}