package com.chengxin.fragment;import android.content.Context;import android.content.Intent;import android.os.Bundle;import android.os.Handler;import android.os.Message;import android.support.v4.app.Fragment;import android.view.LayoutInflater;import android.view.View;import android.view.View.OnClickListener;import android.view.ViewGroup;import android.widget.RelativeLayout;import android.widget.Toast;import com.chengxin.R;import com.chengxin.Entity.AdDomain;import com.chengxin.Entity.AdDomainList;import com.chengxin.Entity.WeiYuanState;import com.chengxin.financial.FinancialMainActivity;import com.chengxin.financial.MyBillActivity;import com.chengxin.global.WeiYuanCommon;import com.chengxin.net.WeiYuanException;public class FinancialManagerFragment extends Fragment implements OnClickListener {	protected static final int MSG_ADVERT_LIST = 0x9000;	private Context mParentContext;	private View mView;		private RelativeLayout mBillManagerLayout;	private RelativeLayout mFinanceLayout;	private AdViewFragment adviewFragment;	@Override	public void onCreate(Bundle savedInstanceState) {		super.onCreate(savedInstanceState);		mParentContext = (Context) FinancialManagerFragment.this.getActivity();	}	@Override	public View onCreateView(LayoutInflater inflater, ViewGroup container,			Bundle savedInstanceState) {		mView = inflater.inflate(R.layout.finance_manager, container, false);		return mView;	}	@Override	public void onDestroy() {		super.onDestroy();	}	@Override	public void onDestroyView() {		super.onDestroyView();		// 内嵌的Fragment GoodsListFragment		if (adviewFragment != null) {			getFragmentManager().beginTransaction().remove(adviewFragment)					.commit();		}	}	@Override	public void onActivityCreated(Bundle savedInstanceState) {		super.onActivityCreated(savedInstanceState);				mBillManagerLayout = (RelativeLayout)mView.findViewById(R.id.layout_bill_man);		mFinanceLayout = (RelativeLayout)mView.findViewById(R.id.layout_finance);		mBillManagerLayout.setOnClickListener(this);		mFinanceLayout.setOnClickListener(this);				adviewFragment = (AdViewFragment) getFragmentManager()				.findFragmentById(R.id.ads_pager_fragment);		getAdList();	}		@Override	public void onClick(View v) {		switch (v.getId()) {		case R.id.layout_bill_man:			Intent intent = new Intent();			intent.setClass(mParentContext, MyBillActivity.class);			mParentContext.startActivity(intent);			break;		case R.id.layout_finance:			intent = new Intent();			intent.setClass(mParentContext, FinancialMainActivity.class);			mParentContext.startActivity(intent);			break;		default:			break;		}	}		private void getAdList() {//		if (AdDomain.hasData()) {//			adviewFragment.setAdList(AdDomain.getAdList());//			return;//		}//				if(!WeiYuanCommon.getNetWorkState()){			return;		}		new Thread(){			public void run() {				try {					AdDomainList tempList =	WeiYuanCommon.getWeiYuanInfo().advertList();					WeiYuanCommon.sendMsg(mHandler, MSG_ADVERT_LIST, tempList);				} catch (WeiYuanException e) {					e.printStackTrace();				}catch (Exception e) {					e.printStackTrace();				}			};		}.start();	}		protected Handler mHandler = new Handler() {		@Override		public void handleMessage(Message msg) {			super.handleMessage(msg);			switch (msg.what) {			case MSG_ADVERT_LIST:				AdDomainList list = (AdDomainList)msg.obj;				if (list != null) {					WeiYuanState state = list.mState;										if (state == null) {						return;					}										if (state.code == 0) {						if (list != null && list.size() > 0) {							AdDomain.setAdList(list.mList);							adviewFragment.setAdList(list.mList);						}					}				}								if (list == null || list.size() == 0) {					adviewFragment.setAdList(WeiYuanCommon.getAdLocalList());				}								break;			}		}	};}